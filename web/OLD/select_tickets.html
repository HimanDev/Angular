
<!DOCTYPE html>
<html>

    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no, width=device-width">
        <link href="css/ionic.min.css" rel="stylesheet">
        <link href="css/select_tickets_style.css" rel="stylesheet">
        <script src="js/ionic.bundle.js"></script>

    </head>

    <body ng-app="app" ng-controller="getTicketsUrl">
    <ion-pane>
        <div class="bar bar-header">
            <a href="http://play.ionic.io/m/5d9f0d55b283" class="button button-icon ion-android-arrow-back"></a>
            <div class="h1 title">Rock Climbing</div>
            <button class="button button-icon icon ion-ios-information-outline"></button>
        </div>
        <div class="bg"></div>

        <ion-content>
            <br>
            <br> 
            <h3 class="padding card">When do you wanna do this?</h3>
            <br>
<!--            <button class="button button-assertive">
                Today <span class="badge badge-assertive">Sold Out</span>
            </button>-->
            <br>
            <div ng-repeat="x in results">
                <a href="ticketcount.html" class="button button-full button-positive button-large">
                    {{x.date}} <span class="badge badge-balanced">{{x.numberOfAvailableTickets}} Tickets</span>
                    <!--<div class="upup">2nd December</div>-->

                </a>
                <br>  
            </div>

           
            <button class="button button-balanced" style="text-align:right; width:130px">
                Future
            </button>
        </ion-content>
    </ion-pane>
    <script>
                var app = angular.module('app', ['ionic']);
                app.controller('getTicketsUrl', function ($scope, $http) {
                    $http.post('https://api.parse.com/1/functions/getTicketsAvailable', {"activityId": "nY8kjrFb8v"},
                    {headers: {'Content-Type': 'application/json',
                            'X-Parse-Application-Id': 'mygNbgzfWdSggHlcU0pcon9TPkeQiHrzPUy2KFUm',
                            'X-Parse-REST-API-Key': 'ImfofbwOkyNh6ZwG4LR1l7XcA5HmYCcJtKqTpqBw'}})
                            .then(function (response) {
                                 var obj = JSON.parse(response.data.result);

                                console.log(obj);

//                            
                                $scope.results = obj;
                            });
                });
    </script>
</body>

</html>