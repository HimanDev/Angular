<!DOCTYPE html>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<html>
    <head>
        <title>TODO supply a title</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <script src="js/jquery-1.11.3.min.js"></script>
        <script src="http://www.parsecdn.com/js/parse-1.4.0.min.js"></script>

        <script>
            $(document).ready(function () {
                Parse.initialize("mygNbgzfWdSggHlcU0pcon9TPkeQiHrzPUy2KFUm", "y0Q7vIAvUoLu3HiWrj5nLY7BUzfxShF41yVEia7X");
//                var GameScore = Parse.Object.extend("DESTINATION");
//                var query = new Parse.Query(GameScore);
//                query.select("NAME", "DESTINATION_IMAGE","FLAG_ACTIVE");
//                query.find({
//                    success: function (results) {
//                        console.log(results);
//                        console.log(results[0].get("NAME"));
//                        console.log(results[0].get("DESTINATION_IMAGE")._url);
//                    },
//                    error: function (error) {
//                    }
//                });

                var dayObjest = {0: "SUN", 1: "MON", 2: "TUE", 3: "WED", 4: "THU", 5: "FRI", 6: "SAT"};
                var date = new Date();
                alert(date.getDay());//ADVANCE_OCCURENCE_BOOK_COUNT 

                var Activity = Parse.Object.extend("ACTIVITY");

                var ActivityTypeDetail = Parse.Object.extend("ACTIVITY_TYPE_DETAIL");


                var activityTypeDetail = new ActivityTypeDetail();
                activityTypeDetail.id = "VAl2q2QHnU";

                var query = new Parse.Query(Activity);
                query.include("ACTIVITY_TYPE_ID");
                query.include("OPERATOR_ID");
                query.include("ACTIVITY_OCCURENCE_ID");
                query.include("ACTIVITY_DURATION_ID");
                query.include("SUB_DETAILS_LIST");
                query.equalTo("ACTIVITY_TYPE_ID", activityTypeDetail);
                query.find({
                    success: function (results) {
                        var availablesDates = [];
                        var advanceOccouranceBookTime = results[0].get("ADVANCE_OCCURENCE_BOOK_COUNT");
                        for (var counter = 0; counter < advanceOccouranceBookTime; counter++) {
                            console.log(results[0].get("ACTIVITY_OCCURENCE_ID").get());
                            if (results[0].get("ACTIVITY_OCCURENCE_ID").get(dayObjest[counter])) {
                                var myDate = new Date();
                                myDate.setDate(myDate.getDate() + counter);
                                availablesDates.push({
                                    availableDates: myDate.toDateString()
                                });
                            }
                        }



                        var jsonObj = [];
                        jsonObj.push({
                            DURATION_TYPE: results[0].get("ACTIVITY_DURATION_ID").get("DURATION_TYPE"),
                            DURATION_VALUE: results[0].get("ACTIVITY_DURATION_ID").get("DURATION_VALUE"),
                            AVAILABLE_DATES: availablesDates,
                            ACTIVITY_SUB_DETAILS: results[0].get("ACTIVITY_SUB_DETAILS")
                        });

                        var jsonString = JSON.stringify(jsonObj);
                        console.log(jsonString);
                    },
                    error: function (error) {
                    }
                });

            });
        </script>
    </head>

    <body>
        <div>TODO write content</div>
    </body>
</html>
